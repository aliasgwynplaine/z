#linux #modules #kernel #fr #sorbonne 
# Linux modules
---
Les modules du linux ajoute des services dans le noyau: pilotes [1d8a-linux-drivers](1d8a-linux-drivers.md), appels systèmes, implementations des protocoles réseau.

Dans linux, il peut être chargé ou déchargé dynamiquement. Les modules s'execute en mode système.

_cheat-sheet_  on linux module development [here](https://cs.xn--ida.live/linux-kernel-modules.html)

Les modules linux doivent toujours avoir une fonction d'initialisation et une fonction de sortie:
```c
/* headers here */

static int __init mod_init(void) { /* ... */ }

static void __exit mod_cleanup(void) { /* ... */ }

module_init(mod_init);
module_exit(mod_cleanup);
```

## Module dependencies
If a module X uses at least one symbol from module Y, then X depends on Y.
The dependencies are automatically inferred when compiled and available at `/lib/module/<version>/module.dep` generated by `depmod`.


### Building a module
The running kernel is deployed with a generic `Makefile` [^1] [[1a4-make]]
```bash
make -C /lib/module/$(uname -r)/build M=$PWD
```

---
[^1]: https://www.kernel.org/doc/Documentation/kbuild/modules.txt